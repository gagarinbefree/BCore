@model BCore.Models.ViewModels.PostViewModel

@using Microsoft.AspNetCore.Identity
@using BCore.Dal.Ef;

@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager



<div class="margin-top"></div>

@if (Model.Comment != null)
{
    <form id="commentForm" asp-action="CommentSubmit" asp-controller="Post" method="post">      
        <div class="form-group">
            <textarea id="commentInput" asp-for="Comment.Text" class="form-control" rows="1">@Model.Comment.Text</textarea>
        </div>
        
        <div class="btn-group">
            <button id="commentSubmitButton" type="submit" class="btn btn-success">
                <span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span> submit
            </button>
        </div>

        <input asp-for="@Model.Id" type="hidden" />
    </form>    
}

@foreach (var comment in Model.Comments)
{
    <div class="media">
        <div class="media-left">            
            @{ 
                var user = await UserManager.FindByIdAsync(comment.UserId);
            }
            <span class="media-object" gravatar-email="@user.Email" image-size="48" width="48"></span>
        </div>
        <div class="media-body">
            <h4 class="media-heading"><strong>@user.UserName</strong></h4>
            @comment.DateTime.ToString("dd.MM.yyyy hh:mm")                        
        </div>
    </div>
    <small>@comment.Text</small>
}
